<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wniosek o ubezpieczenie dla fizyków medycznych</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .form-section {
            transition: all 0.3s ease;
        }

        .form-section.collapsed {
            opacity: 0.7;
        }

        .form-section.collapsed .section-content {
            display: none;
        }

        .required-field::after {
            content: "*";
            color: #ef4444;
            margin-left: 2px;
        }

        .success-message {
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body class="bg-gray-50 font-sans">
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- Header -->
        <header class="bg-blue-800 text-white rounded-lg shadow-md p-6 mb-8">
            <div class="flex items-center">
                <div class="mr-4">
                    <i class="fas fa-shield-alt text-4xl"></i>
                </div>
                <div>
                    <h1 class="text-3xl font-bold">Wniosek o zawarcie umowy ubezpieczenia</h1>
                    <p class="text-blue-200 mt-2">Współpraca z Ogólnopolskim Związkiem Zawodowym Fizyków Medycznych</p>
                </div>
                <div class="mb-4 sm:mb-0 sm:mr-6 ml-auto">
                    <img src="logo.png" alt="Company Logo" class="h-18">
                </div>
            </div>
        </header>

        <!-- Form Container -->
        <div class="bg-white rounded-lg shadow-md overflow-hidden">
            <!-- Progress Bar -->
            <div class="bg-gray-200 h-2">
                <div id="progress-bar" class="bg-blue-600 h-2 transition-all duration-300" style="width: 0%"></div>
            </div>

            <!-- Form Sections -->
            <form id="insurance-form"
                action="https://script.google.com/macros/s/AKfycbyYjrcRFYreRAdgFeSSHpYpN2XrC_hlx30g8q8qe0nOZUaQL2zHTx15nxYvZn9e-lzJ/exec"
                method="POST" class="p-6">
                <!-- Success Message (hidden by default) -->
                <div id="success-message"
                    class="success-message hidden bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-6">
                    <div class="flex items-center">
                        <i class="fas fa-check-circle text-green-500 mr-2"></i>
                        <span class="font-bold"> Dziękujemy!</span>
                    </div>
                    <p class="mt-2">Twój wniosek został pomyślnie wysłany. Dziękujemy!</p>
                </div>

                <!-- Error Message (hidden by default) -->
                <div id="error-message"
                    class="hidden bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6">
                    <div class="flex items-center">
                        <i class="fas fa-exclamation-circle text-red-500 mr-2"></i>
                        <span class="font-bold">Błąd!</span>
                    </div>
                    <p class="mt-2">Wystąpił problem podczas przesyłania formularza. Proszę sprawdzić wszystkie wymagane
                        pola i spróbować ponownie.</p>
                </div>

                <!-- Section I: General Information -->
                <div class="form-section mb-8 border-b pb-6">
                    <div class="section-header flex justify-between items-center cursor-pointer">
                        <h2 class="text-xl font-semibold text-blue-800 flex items-center">
                            <i class="fas fa-user-circle mr-2"></i>
                            <span>I. Informacje ogólne</span>
                        </h2>
                        <i class="fas fa-chevron-down text-blue-800 transition-transform duration-300"></i>
                    </div>
                    <div class="section-content mt-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label for="full-name"
                                    class="block text-sm font-medium text-gray-700 required-field">Imię i
                                    nazwisko</label>
                                <input type="text" id="full-name" name="full-name"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border">
                            </div>
                            <div>
                                <label for="address"
                                    class="block text-sm font-medium text-gray-700 required-field">Adres</label>
                                <input type="text" id="address" name="address"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border">
                            </div>
                            <div>
                                <label for="phone"
                                    class="block text-sm font-medium text-gray-700 required-field">Telefon</label>
                                <input type="tel" id="phone" name="phone"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border">
                            </div>
                            <div>
                                <label for="email"
                                    class="block text-sm font-medium text-gray-700 required-field">E-mail</label>
                                <input type="email" id="email" name="email"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border">
                            </div>
                            <div>
                                <label for="fax" class="block text-sm font-medium text-gray-700">Faks
                                    (opcjonalnie)</label>
                                <input type="text" id="fax" name="fax"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border">
                            </div>
                            <div>
                                <label for="regon" class="block text-sm font-medium text-gray-700">REGON</label>
                                <input type="text" id="regon" name="regon"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border">
                            </div>
                            <div>
                                <label for="nip" class="block text-sm font-medium text-gray-700">NIP</label>
                                <input type="text" id="nip" name="nip"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border">
                            </div>
                            <div>
                                <label for="pesel"
                                    class="block text-sm font-medium text-gray-700 required-field">PESEL</label>
                                <input type="text" id="pesel" name="pesel"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section II: Insurance Period -->
                <div class="form-section mb-8 border-b pb-6">
                    <div class="section-header flex justify-between items-center cursor-pointer">
                        <h2 class="text-xl font-semibold text-blue-800 flex items-center">
                            <i class="fas fa-calendar-alt mr-2"></i>
                            <span>II. Okres ubezpieczenia</span>
                        </h2>
                        <i class="fas fa-chevron-down text-blue-800 transition-transform duration-300"></i>
                    </div>
                    <div class="section-content mt-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label for="start-date"
                                    class="block text-sm font-medium text-gray-700 required-field">Data
                                    rozpoczęcia</label>
                                <input type="date" id="start-date" name="start-date"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border">
                            </div>
                            <div>
                                <label for="end-date"
                                    class="block text-sm font-medium text-gray-700 required-field">Data
                                    zakończenia</label>
                                <input type="date" id="end-date" name="end-date"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border bg-gray-100 cursor-not-allowed"
                                    readonly>
                                <!-- Added bg-gray-100, cursor-not-allowed, and readonly attribute -->
                            </div>
                        </div>
                        <p class="text-xs text-gray-500 mt-2">Okres ubezpieczenia wynosi 12 miesięcy. Data zakończenia
                            zostanie ustawiona automatycznie.</p>
                    </div>
                </div>

                <!-- NEW Section III: Informacje dodatkowe -->
                <div class="form-section mb-8 border-b pb-6">
                    <div class="section-header flex justify-between items-center cursor-pointer">
                        <h2 class="text-xl font-semibold text-blue-800 flex items-center">
                            <i class="fas fa-info-circle mr-2"></i>
                            <span>III. Informacje dodatkowe</span>
                        </h2>
                        <i class="fas fa-chevron-down text-blue-800 transition-transform duration-300"></i>
                    </div>
                    <div class="section-content mt-4 space-y-4">
                        <div>
                            <label for="turnover" class="block text-sm font-medium text-gray-700">1. Wysokość obrotów w
                                ostatnim okresie obrachunkowym (lub planowanych dla nowych działalności)</label>
                            <input type="text" id="turnover" name="turnover" placeholder="np. 150000 PLN"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border">
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-center">
                            <div>
                                <label class="block text-sm font-medium text-gray-700">2. W ciągu ostatniego roku
                                    wypłacone zostały odszkodowania</label>
                            </div>
                            <div class="flex items-center space-x-4">
                                <div class="flex items-center">
                                    <input id="claims-paid-yes" name="claims-paid" type="radio" value="yes"
                                        class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300">
                                    <label for="claims-paid-yes" class="ml-2 block text-sm text-gray-700">TAK</label>
                                </div>
                                <div class="flex items-center">
                                    <input id="claims-paid-no" name="claims-paid" type="radio" value="no"
                                        class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300">
                                    <label for="claims-paid-no" class="ml-2 block text-sm text-gray-700">NIE</label>
                                </div>
                            </div>
                        </div>
                        <div id="claims-amount-div" class="hidden">
                            <label for="claims-amount" class="block text-sm font-medium text-gray-700">Na łączną kwotę
                                (PLN)</label>
                            <input type="number" step="0.01" id="claims-amount" name="claims-amount"
                                placeholder="np. 5000.00"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700">3. Jestem członkiem Ogólnopolskiego
                                Związku Zawodowego Fizyków Medycznych</label>
                            <div class="mt-2 flex space-x-4">
                                <div class="flex items-center">
                                    <input id="member-ozzfm-yes" name="member-ozzfm" type="radio" value="yes"
                                        class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300">
                                    <label for="member-ozzfm-yes" class="ml-2 block text-sm text-gray-700">TAK</label>
                                </div>
                                <div class="flex items-center">
                                    <input id="member-ozzfm-no" name="member-ozzfm" type="radio" value="no"
                                        class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300">
                                    <label for="member-ozzfm-no" class="ml-2 block text-sm text-gray-700">NIE</label>
                                </div>
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700">4. Jestem członkiem Polskiego
                                Towarzystwa Fizyki Medycznej</label>
                            <div class="mt-2 flex space-x-4">
                                <div class="flex items-center">
                                    <input id="member-ptfm-yes" name="member-ptfm" type="radio" value="yes"
                                        class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300">
                                    <label for="member-ptfm-yes" class="ml-2 block text-sm text-gray-700">TAK</label>
                                </div>
                                <div class="flex items-center">
                                    <input id="member-ptfm-no" name="member-ptfm" type="radio" value="no"
                                        class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300">
                                    <label for="member-ptfm-no" class="ml-2 block text-sm text-gray-700">NIE</label>
                                </div>
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700">5. Jestem technikiem
                                elektroradiologiem</label>
                            <div class="mt-2 flex space-x-4">
                                <div class="flex items-center">
                                    <input id="is-radiographer-yes" name="is-radiographer" type="radio" value="yes"
                                        class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300">
                                    <label for="is-radiographer-yes"
                                        class="ml-2 block text-sm text-gray-700">TAK</label>
                                </div>
                                <div class="flex items-center">
                                    <input id="is-radiographer-no" name="is-radiographer" type="radio" value="no"
                                        class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300">
                                    <label for="is-radiographer-no" class="ml-2 block text-sm text-gray-700">NIE</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section IV: Wnioskowane ubezpieczenia -->
                <div class="form-section mb-8 border-b pb-6">
                    <div class="section-header flex justify-between items-center cursor-pointer">
                        <h2 class="text-xl font-semibold text-blue-800 flex items-center">
                            <i class="fas fa-file-contract mr-2"></i>
                            <span>IV. Wnioskowane ubezpieczenia</span>
                        </h2>
                        <i class="fas fa-chevron-down text-blue-800 transition-transform duration-300"></i>
                    </div>
                    <div class="section-content mt-4">
                        <div class="space-y-6">

                            <!-- 1. Ubezpieczenie OC zawodowego -->
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <h3 class="font-medium text-blue-800 mb-1">1. Ubezpieczenie OC zawodowego</h3>
                                <p class="text-sm text-gray-600 mb-3">Dla fizyków medycznych i techników
                                    elektroradiologów.</p>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 required-field">Członek
                                            Związku / Towarzystwa*</label>
                                        <div class="mt-2 flex space-x-4">
                                            <div class="flex items-center">
                                                <input id="member-yes" name="association-member" type="radio"
                                                    value="yes"
                                                    class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300">
                                                <label for="member-yes"
                                                    class="ml-2 block text-sm text-gray-700">TAK</label>
                                            </div>
                                            <div class="flex items-center">
                                                <input id="member-no" name="association-member" type="radio" value="no"
                                                    class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300">
                                                <label for="member-no"
                                                    class="ml-2 block text-sm text-gray-700">NIE</label>
                                            </div>
                                        </div>
                                        <p class="text-xs text-gray-500 mt-1">* Dotyczy członkostwa w OZZFM lub PTFM dla
                                            celów składki OC.</p>
                                    </div>
                                    <div>
                                        <label for="sum-guaranteed-oc-zawodowe"
                                            class="block text-sm font-medium text-gray-700 required-field">Suma
                                            gwarancyjna</label>
                                        <select id="sum-guaranteed-oc-zawodowe" name="sum-guaranteed-oc-zawodowe"
                                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border">
                                            <option value="">Wybierz sumę gwarancyjną</option>
                                            <option value="25000">25 000 PLN</option>
                                            <option value="50000">50 000 PLN</option>
                                            <option value="100000">100 000 PLN</option>
                                            <option value="250000">250 000 PLN</option>
                                            <option value="500000">500 000 PLN</option>
                                            <option value="600000">600 000 PLN</option>
                                            <option value="700000">700 000 PLN</option>
                                            <option value="800000">800 000 PLN</option>
                                            <option value="1000000">1 000 000 PLN</option>
                                            <option value="1500000">1 500 000 PLN</option>
                                            <option value="2000000">2 000 000 PLN</option>
                                            <option value="2500000">2 500 000 PLN</option>
                                            <option value="3000000">3 000 000 PLN</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="mt-4 pt-4 border-t border-blue-200">
                                    <p class="text-lg font-semibold text-blue-700">
                                        Obliczona składka OC Zawodowego: <span id="oc-zawodowe-premium-display"
                                            class="text-xl text-blue-900">--- PLN</span>
                                    </p>
                                </div>
                                <input type="hidden" id="calculated-oc-zawodowe-premium"
                                    name="calculated-oc-zawodowe-premium">
                            </div>

                            <!-- 2. Ubezpieczenie NNW (Accident Insurance) - REINSTATED -->
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <h3 class="font-medium text-blue-800 mb-1">2. Ubezpieczenie NNW z rozszerzeniami</h3>
                                <p class="text-sm text-gray-600 mb-3">Następstwa nieszczęśliwych wypadków i świadczenia
                                    dodatkowe.</p>
                                <div class="space-y-3">
                                    <div class="flex items-center">
                                        <input id="nnw-opt-in" name="nnw-opt-in" type="checkbox"
                                            class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                        <label for="nnw-opt-in"
                                            class="ml-2 block text-sm font-medium text-gray-800">Chcę ubezpieczenie
                                            NNW</label>
                                    </div>

                                    <div id="nnw-options-div"
                                        class="ml-4 pl-4 border-l-2 border-blue-200 space-y-3 hidden">
                                        <div>
                                            <label for="nnw-sum-guaranteed"
                                                class="block text-sm font-medium text-gray-700">Suma gwarancyjna
                                                NNW</label>
                                            <select id="nnw-sum-guaranteed" name="nnw-sum-guaranteed"
                                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border">
                                                <option value="">Wybierz sumę</option>
                                                <option value="10000">10 000 PLN (Koszty leczenia 5 000 PLN)</option>
                                                <option value="20000">20 000 PLN (Koszty leczenia 10 000 PLN)</option>
                                                <option value="50000">50 000 PLN (Koszty leczenia 15 000 PLN)</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700">Członek Związku /
                                                Towarzystwa (dla NNW)*</label>
                                            <div class="mt-1 flex space-x-4">
                                                <div class="flex items-center">
                                                    <input id="nnw-member-yes" name="nnw-association-member"
                                                        type="radio" value="yes"
                                                        class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300">
                                                    <label for="nnw-member-yes"
                                                        class="ml-2 block text-sm text-gray-700">TAK</label>
                                                </div>
                                                <div class="flex items-center">
                                                    <input id="nnw-member-no" name="nnw-association-member" type="radio"
                                                        value="no"
                                                        class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300">
                                                    <label for="nnw-member-no"
                                                        class="ml-2 block text-sm text-gray-700">NIE</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="text-sm text-gray-600">
                                            <p><span class="font-medium">Świadczenie jednorazowe WZW:</span> 50 000 PLN
                                                (w wybranych wariantach)</p>
                                            <p><span class="font-medium">Świadczenie jednorazowe HIV:</span> 50 000 PLN
                                                (w wybranych wariantach)</p>
                                        </div>
                                        <div class="mt-2 pt-2 border-t border-blue-200">
                                            <p class="text-md font-semibold text-blue-700">
                                                Obliczona składka NNW: <span id="nnw-premium-display"
                                                    class="text-lg text-blue-900">--- PLN</span>
                                            </p>
                                        </div>
                                        <input type="hidden" id="calculated-nnw-premium" name="calculated-nnw-premium">
                                    </div>
                                </div>
                            </div>

                            <!-- 3. Ubezpieczenie OC świadczeniodawcy -->
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <h3 class="font-medium text-blue-800 mb-1">3. Ubezpieczenie OC świadczeniodawcy</h3>
                                <p class="text-sm text-gray-600 mb-3">Dla niebędącego podmiotem wykonującym działalność
                                    leczniczą, udzielającego świadczeń opieki zdrowotnej.</p>
                                <div class="space-y-3">
                                    <div class="flex items-center">
                                        <input id="oc-swiad-opt-in" name="oc-swiad-opt-in" type="checkbox"
                                            class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                        <label for="oc-swiad-opt-in"
                                            class="ml-2 block text-sm font-medium text-gray-800">Chcę ubezpieczenie OC
                                            świadczeniodawcy</label>
                                    </div>
                                    <div id="oc-swiad-options-div"
                                        class="ml-4 pl-4 border-l-2 border-blue-200 space-y-3 hidden">
                                        <p class="text-sm text-gray-700"><span class="font-medium">Suma
                                                gwarancyjna:</span> 30.000 EUR / jedno zdarzenie, 150.000 EUR /
                                            wszystkie zdarzenia.</p>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700">Członek Związku /
                                                Towarzystwa*</label>
                                            <div class="mt-1 flex space-x-4">
                                                <div class="flex items-center">
                                                    <input id="oc-swiad-member-yes" name="oc-swiad-association-member"
                                                        type="radio" value="yes"
                                                        class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300">
                                                    <label for="oc-swiad-member-yes"
                                                        class="ml-2 block text-sm text-gray-700">TAK</label>
                                                </div>
                                                <div class="flex items-center">
                                                    <input id="oc-swiad-member-no" name="oc-swiad-association-member"
                                                        type="radio" value="no"
                                                        class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300">
                                                    <label for="oc-swiad-member-no"
                                                        class="ml-2 block text-sm text-gray-700">NIE</label>
                                                </div>
                                            </div>
                                            <p class="text-xs text-gray-500 mt-1">* Dla celów składki OC
                                                świadczeniodawcy.</p>
                                        </div>
                                        <div class="mt-2 pt-2 border-t border-blue-200">
                                            <p class="text-md font-semibold text-blue-700">
                                                Obliczona składka OC Świadczeniodawcy: <span
                                                    id="oc-swiad-premium-display" class="text-lg text-blue-900">---
                                                    PLN</span>
                                            </p>
                                        </div>
                                        <input type="hidden" id="calculated-oc-swiad-premium"
                                            name="calculated-oc-swiad-premium">
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>

                <!-- Section V: Payment -->
                <div class="form-section mb-8 border-b pb-6">
                    <div class="section-header flex justify-between items-center cursor-pointer">
                        <h2 class="text-xl font-semibold text-blue-800 flex items-center">
                            <i class="fas fa-credit-card mr-2"></i>
                            <span>V. Płatność</span>
                        </h2>
                        <i class="fas fa-chevron-down text-blue-800 transition-transform duration-300"></i>
                    </div>
                    <div class="section-content mt-4">
                        <div class="space-y-4">
                            <div class="flex items-center">
                                <input id="payment-single" name="payment-type" type="radio" value="single"
                                    class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300">
                                <label for="payment-single" class="ml-2 block text-sm text-gray-700">Płatność
                                    jednorazowa</label>
                            </div>
                            <div class="flex items-center">
                                <input id="payment-installments" name="payment-type" type="radio" value="installments"
                                    class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300">
                                <label for="payment-installments" class="ml-2 block text-sm text-gray-700">Płatność w
                                    dwóch ratach</label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section VI: Declarations -->
                <div class="form-section mb-8 border-b pb-6">
                    <div class="section-header flex justify-between items-center cursor-pointer">
                        <h2 class="text-xl font-semibold text-blue-800 flex items-center">
                            <i class="fas fa-file-signature mr-2"></i>
                            <span>VI. Oświadczenia</span>
                        </h2>
                        <i class="fas fa-chevron-down text-blue-800 transition-transform duration-300"></i>
                    </div>
                    <div class="section-content mt-4">
                        <div class="space-y-4">
                            <div class="flex items-start">
                                <div class="flex items-center h-5">
                                    <input id="declaration1" name="declaration1" type="checkbox"
                                        class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                </div>
                                <label for="declaration1" class="ml-2 block text-sm text-gray-700 required-field">
                                    Oświadczam, że podane przeze mnie dane są prawdziwe i kompletne. Jestem świadomy/a,
                                    że podanie nieprawdziwych danych może skutkować odmową wypłaty odszkodowania.
                                </label>
                            </div>
                            <div class="flex items-start">
                                <div class="flex items-center h-5">
                                    <input id="declaration2" name="declaration2" type="checkbox"
                                        class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                </div>
                                <label for="declaration2" class="ml-2 block text-sm text-gray-700 required-field">
                                    Upoważniam brokera ubezpieczeniowego do występowania w moim imieniu do Towarzystwa
                                    Ubezpieczeniowego w sprawach związanych z zawarciem i realizacją umowy
                                    ubezpieczenia.
                                </label>
                            </div>
                            <div class="flex items-start">
                                <div class="flex items-center h-5">
                                    <input id="declaration3" name="declaration3" type="checkbox"
                                        class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                </div>
                                <label for="declaration3" class="ml-2 block text-sm text-gray-700 required-field">
                                    Wyrażam zgodę na przetwarzanie moich danych osobowych w celu zawarcia i realizacji
                                    umowy ubezpieczenia zgodnie z obowiązującymi przepisami o ochronie danych osobowych.
                                </label>
                            </div>
                            <div class="flex items-start">
                                <div class="flex items-center h-5">
                                    <input id="declaration4" name="declaration4" type="checkbox"
                                        class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                </div>
                                <label for="declaration4" class="ml-2 block text-sm text-gray-700 required-field">
                                    Zapoznałem/am się z warunkami programu ubezpieczeniowego i akceptuję jego
                                    postanowienia.
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Signature Section -->
                <div class="form-section mb-8">
                    <div class="section-header flex justify-between items-center cursor-pointer">
                        <h2 class="text-xl font-semibold text-blue-800 flex items-center">
                            <i class="fas fa-pen-fancy mr-2"></i>
                            <span>Podpis i lokalizacja</span>
                        </h2>
                        <i class="fas fa-chevron-down text-blue-800 transition-transform duration-300"></i>
                    </div>
                    <div class="section-content mt-4">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label for="location"
                                    class="block text-sm font-medium text-gray-700 required-field">Miejscowość</label>
                                <input type="text" id="location" name="location"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border">
                            </div>
                            <div>
                                <label for="sign-date"
                                    class="block text-sm font-medium text-gray-700 required-field">Data</label>
                                <input type="date" id="sign-date" name="sign-date"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border bg-gray-100 cursor-not-allowed" readonly>
                            </div>
                            <div>
                                <label for="signature"
                                    class="block text-sm font-medium text-gray-700 required-field">Podpis (imię i
                                    nazwisko)</label>
                                <input type="text" id="signature" name="signature"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="mt-8 flex justify-center">
                    <button type="submit" id="submit-btn"
                        class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg shadow-md transition duration-300 flex items-center">
                        <i class="fas fa-paper-plane mr-2"></i>
                        Wyślij wniosek
                    </button>
                </div>
            </form>
        </div>

        <!-- Footer -->
        <footer class="mt-8 text-center text-gray-500 text-sm">
            <p>© 2023 Ogólnopolski Związek Zawodowy Fizyków Medycznych. Wszelkie prawa zastrzeżone.</p>
        </footer>
    </div>

        <script>
        document.addEventListener('DOMContentLoaded', function () {
            const form = document.getElementById('insurance-form');
            if (!form) {
                console.error("Form with ID 'insurance-form' not found!");
                return;
            }

            // --- Global Element Selectors ---
            const allRequiredFieldLabels = Array.from(form.querySelectorAll('.required-field'));
            const signDateInput = document.getElementById('sign-date');
            const startDateInput = document.getElementById('start-date');
            const endDateInput = document.getElementById('end-date');
            const claimsPaidRadios = document.querySelectorAll('input[name="claims-paid"]');
            const claimsAmountDiv = document.getElementById('claims-amount-div');
            const claimsAmountInput = document.getElementById('claims-amount');

            const sumGuaranteedOcZawodoweSelect = document.getElementById('sum-guaranteed-oc-zawodowe');
            const associationMemberOcZawodoweRadios = document.querySelectorAll('input[name="association-member"]');
            const ocZawodowePremiumDisplay = document.getElementById('oc-zawodowe-premium-display');
            const calculatedOcZawodowePremiumInput = document.getElementById('calculated-oc-zawodowe-premium');

            const nnwOptInCheckbox = document.getElementById('nnw-opt-in');
            const nnwOptionsDiv = document.getElementById('nnw-options-div');
            const nnwSumGuaranteedSelect = document.getElementById('nnw-sum-guaranteed');
            const nnwAssociationMemberRadios = document.querySelectorAll('input[name="nnw-association-member"]');
            const nnwPremiumDisplay = document.getElementById('nnw-premium-display');
            const calculatedNnwPremiumInput = document.getElementById('calculated-nnw-premium');

            const ocSwiadOptInCheckbox = document.getElementById('oc-swiad-opt-in');
            const ocSwiadOptionsDiv = document.getElementById('oc-swiad-options-div');
            const ocSwiadAssociationMemberRadios = document.querySelectorAll('input[name="oc-swiad-association-member"]');
            const ocSwiadPremiumDisplay = document.getElementById('oc-swiad-premium-display');
            const calculatedOcSwiadPremiumInput = document.getElementById('calculated-oc-swiad-premium');

            const successMessageDiv = document.getElementById('success-message');
            const errorMessageDiv = document.getElementById('error-message');
            const submitBtn = document.getElementById('submit-btn');
            const progressBar = document.getElementById('progress-bar');

            // --- Premium Data Objects ---
            const ocZawodowePremiums = {
                "25000":  { member: 165, nonMember: 212 }, "50000":  { member: 294, nonMember: 320 },
                "100000": { member: 405, nonMember: 440 }, "250000": { member: 655, nonMember: 712 },
                "500000": { member: 975, nonMember: 1112 }, "600000": { member: 1156, nonMember: 1256 },
                "700000": { member: 1225, nonMember: 1400 }, "800000": { member: 1420, nonMember: 1544 },
                "1000000":{ member: 1605, nonMember: 1832 }, "1500000":{ member: 2237, nonMember: 2432 },
                "2000000":{ member: 2655, nonMember: 3032 }, "2500000":{ member: 3341, nonMember: 3632 },
                "3000000":{ member: 3673, nonMember: 3992 }
            };
            const nnwPremiums = {
                "10000": { member: 140, nonMember: 150 },
                "20000": { member: 220, nonMember: 240 },
                "50000": { member: 370, nonMember: 405 }
            };
            const ocSwiadPremiums = { member: 99, nonMember: 112 };

            // --- Helper Functions ---
            function formatCurrency(amount) {
                if (typeof amount !== 'number' || isNaN(amount)) return "--- PLN";
                return amount.toLocaleString('pl-PL') + " PLN";
            }
            function getLocalDateString(dateObj) {
                const year = dateObj.getFullYear();
                const month = (dateObj.getMonth() + 1).toString().padStart(2, '0');
                const day = dateObj.getDate().toString().padStart(2, '0');
                return `${year}-${month}-${day}`;
            }
            function styleError(element, addError) {
                if (!element) return;
                if (element.type === 'radio' || element.type === 'checkbox') {
                    const parentGroup = element.closest('div.mt-2.flex.space-x-4, div.mt-1.flex.space-x-4, div.flex.items-start');
                    if (parentGroup) {
                        parentGroup.classList.toggle('border-red-500', addError);
                        parentGroup.classList.toggle('border-2', addError);
                        parentGroup.classList.toggle('rounded-md', addError);
                        parentGroup.classList.toggle('p-1', addError);
                    }
                } else {
                    element.classList.toggle('border-red-500', addError);
                }
            }

            // --- Initialization & Event Listeners ---
            if (signDateInput) signDateInput.value = getLocalDateString(new Date()); // readonly is in HTML
            if (startDateInput) startDateInput.setAttribute('min', getLocalDateString(new Date()));

            if (startDateInput && endDateInput) {
                startDateInput.addEventListener('change', function() { /* ... (existing start/end date logic - ensure it uses getLocalDateString for consistency) ... */ 
                    if (this.value) {
                        const selectedStartDate = new Date(this.value);
                        const minDate = new Date(startDateInput.min); minDate.setHours(0,0,0,0);
                        if (selectedStartDate < minDate) {
                            alert("Data rozpoczęcia nie może być wcześniejsza niż dzisiejsza data.");
                            this.value = startDateInput.min; this.dispatchEvent(new Event('change')); return;
                        }
                        const calculatedEndDate = new Date(selectedStartDate);
                        calculatedEndDate.setFullYear(calculatedEndDate.getFullYear() + 1);
                        endDateInput.value = getLocalDateString(calculatedEndDate);
                    } else { endDateInput.value = ''; }
                });
            }

            if (claimsPaidRadios.length && claimsAmountDiv && claimsAmountInput) {
                claimsPaidRadios.forEach(radio => radio.addEventListener('change', function() {
                    const isYes = this.value === 'yes' && this.checked;
                    claimsAmountDiv.classList.toggle('hidden', !isYes);
                    if (isYes) claimsAmountInput.setAttribute('required', 'required');
                    else { claimsAmountInput.removeAttribute('required'); claimsAmountInput.value = ''; styleError(claimsAmountInput, false); }
                }));
            }

            // OC Zawodowe Premium
            function calculateAndDisplayOcZawodowePremium() { /* ... (existing logic, use formatCurrency) ... */
                if (!sumGuaranteedOcZawodoweSelect || !ocZawodowePremiumDisplay || !associationMemberOcZawodoweRadios.length || !calculatedOcZawodowePremiumInput) return;
                const selectedSum = sumGuaranteedOcZawodoweSelect.value;
                const memberRadio = Array.from(associationMemberOcZawodoweRadios).find(r => r.checked);
                const isMember = memberRadio && memberRadio.value === 'yes';
                const membershipChosen = !!memberRadio;
                if (selectedSum && membershipChosen && ocZawodowePremiums[selectedSum]) {
                    const premium = isMember ? ocZawodowePremiums[selectedSum].member : ocZawodowePremiums[selectedSum].nonMember;
                    ocZawodowePremiumDisplay.textContent = formatCurrency(premium); calculatedOcZawodowePremiumInput.value = premium;
                } else { ocZawodowePremiumDisplay.textContent = "--- PLN"; calculatedOcZawodowePremiumInput.value = ""; }
            }
            if (sumGuaranteedOcZawodoweSelect) sumGuaranteedOcZawodoweSelect.addEventListener('change', calculateAndDisplayOcZawodowePremium);
            associationMemberOcZawodoweRadios.forEach(radio => radio.addEventListener('change', calculateAndDisplayOcZawodowePremium));

            // NNW Opt-in & Premium
            function toggleNnwOptions() { /* ... (existing logic, call calculateAndDisplayNnwPremium) ... */
                if (!nnwOptInCheckbox || !nnwOptionsDiv || !nnwSumGuaranteedSelect || !nnwAssociationMemberRadios.length) return;
                const isOptedIn = nnwOptInCheckbox.checked;
                nnwOptionsDiv.classList.toggle('hidden', !isOptedIn);
                const nnwSumLabel = document.querySelector('label[for="nnw-sum-guaranteed"]');
                const nnwMemberLabel = nnwSumGuaranteedSelect.parentElement.nextElementSibling.querySelector('label');

                if (isOptedIn) {
                    nnwSumGuaranteedSelect.setAttribute('required', 'required');
                    if (nnwSumLabel) nnwSumLabel.classList.add('required-field');
                    if (nnwMemberLabel) nnwMemberLabel.classList.add('required-field'); // Add to the group label
                } else {
                    nnwSumGuaranteedSelect.removeAttribute('required'); nnwSumGuaranteedSelect.value = ''; styleError(nnwSumGuaranteedSelect, false);
                    nnwAssociationMemberRadios.forEach(r => { r.checked = false; }); styleError(nnwAssociationMemberRadios[0], false); // Clear group style
                    if (nnwPremiumDisplay) nnwPremiumDisplay.textContent = "--- PLN";
                    if (calculatedNnwPremiumInput) calculatedNnwPremiumInput.value = "";
                    if (nnwSumLabel) nnwSumLabel.classList.remove('required-field');
                    if (nnwMemberLabel) nnwMemberLabel.classList.remove('required-field');
                }
                calculateAndDisplayNnwPremium();
            }
            function calculateAndDisplayNnwPremium() { /* ... (existing logic, use formatCurrency) ... */
                if (!nnwOptInCheckbox || !nnwOptInCheckbox.checked || !nnwSumGuaranteedSelect || !nnwPremiumDisplay || !nnwAssociationMemberRadios.length || !calculatedNnwPremiumInput) {
                    if (nnwPremiumDisplay) nnwPremiumDisplay.textContent = "--- PLN"; if (calculatedNnwPremiumInput) calculatedNnwPremiumInput.value = ""; return;
                }
                const selectedSum = nnwSumGuaranteedSelect.value;
                const memberRadio = Array.from(nnwAssociationMemberRadios).find(r => r.checked);
                const isMember = memberRadio && memberRadio.value === 'yes';
                const membershipChosen = !!memberRadio;
                if (selectedSum && membershipChosen && nnwPremiums[selectedSum]) {
                    const premium = isMember ? nnwPremiums[selectedSum].member : nnwPremiums[selectedSum].nonMember;
                    nnwPremiumDisplay.textContent = formatCurrency(premium); calculatedNnwPremiumInput.value = premium;
                } else { nnwPremiumDisplay.textContent = "--- PLN"; calculatedNnwPremiumInput.value = ""; }
            }
            if (nnwOptInCheckbox) nnwOptInCheckbox.addEventListener('change', toggleNnwOptions);
            if (nnwSumGuaranteedSelect) nnwSumGuaranteedSelect.addEventListener('change', calculateAndDisplayNnwPremium);
            nnwAssociationMemberRadios.forEach(radio => radio.addEventListener('change', calculateAndDisplayNnwPremium));

            // OC Świadczeniodawcy Opt-in & Premium
            function toggleOcSwiadOptions() { /* ... (existing logic, call calculateAndDisplayOcSwiadPremium) ... */
                if (!ocSwiadOptInCheckbox || !ocSwiadOptionsDiv || !ocSwiadAssociationMemberRadios.length) return;
                const isOptedIn = ocSwiadOptInCheckbox.checked;
                ocSwiadOptionsDiv.classList.toggle('hidden', !isOptedIn);
                const ocSwiadMemberLabel = ocSwiadAssociationMemberRadios[0].closest('div.mt-1.flex.space-x-4').previousElementSibling;

                if (isOptedIn) {
                    if(ocSwiadMemberLabel) ocSwiadMemberLabel.classList.add('required-field');
                } else {
                    ocSwiadAssociationMemberRadios.forEach(r => { r.checked = false; }); styleError(ocSwiadAssociationMemberRadios[0], false);
                    if (ocSwiadPremiumDisplay) ocSwiadPremiumDisplay.textContent = "--- PLN";
                    if (calculatedOcSwiadPremiumInput) calculatedOcSwiadPremiumInput.value = "";
                    if(ocSwiadMemberLabel) ocSwiadMemberLabel.classList.remove('required-field');
                }
                calculateAndDisplayOcSwiadPremium();
            }
            function calculateAndDisplayOcSwiadPremium() { /* ... (existing logic, use formatCurrency) ... */
                if (!ocSwiadOptInCheckbox || !ocSwiadOptInCheckbox.checked || !ocSwiadPremiumDisplay || !ocSwiadAssociationMemberRadios.length || !calculatedOcSwiadPremiumInput) {
                    if (ocSwiadPremiumDisplay) ocSwiadPremiumDisplay.textContent = "--- PLN"; if (calculatedOcSwiadPremiumInput) calculatedOcSwiadPremiumInput.value = ""; return;
                }
                const memberRadio = Array.from(ocSwiadAssociationMemberRadios).find(r => r.checked);
                const isMember = memberRadio && memberRadio.value === 'yes';
                const membershipChosen = !!memberRadio;
                if (membershipChosen) {
                    const premium = isMember ? ocSwiadPremiums.member : ocSwiadPremiums.nonMember;
                    ocSwiadPremiumDisplay.textContent = formatCurrency(premium); calculatedOcSwiadPremiumInput.value = premium;
                } else { ocSwiadPremiumDisplay.textContent = "--- PLN"; calculatedOcSwiadPremiumInput.value = ""; }
            }
            if (ocSwiadOptInCheckbox) ocSwiadOptInCheckbox.addEventListener('change', toggleOcSwiadOptions);
            ocSwiadAssociationMemberRadios.forEach(radio => radio.addEventListener('change', calculateAndDisplayOcSwiadPremium));

            // Collapsible sections
            const sectionHeaders = document.querySelectorAll('.section-header');
            sectionHeaders.forEach(header => { /* ... (your existing logic) ... */
                header.addEventListener('click', function () {
                    const section = this.parentElement;
                    const icon = this.querySelector('i.fa-chevron-down');
                    if (icon) { section.classList.toggle('collapsed'); icon.classList.toggle('rotate-180'); }
                });
            });

            // --- Blur Validation ---
            // This is a more generic blur validation. Modify if very specific styling per field type is needed.
            form.querySelectorAll('input:not([type="hidden"]), select, textarea').forEach(input => {
                const eventType = (input.type === 'select-one' || input.type === 'date' || input.type === 'radio' || input.type === 'checkbox') ? 'change' : 'blur';
                input.addEventListener(eventType, function() {
                    let isFieldValid = true;
                    let elementToStyle = this;
                    const associatedLabel = form.querySelector(`label[for="${this.id}"].required-field`) || 
                                          this.closest('div.grid > div, div.space-y-4 > div, div.flex.items-start')?.querySelector('label.required-field');

                    if (this.hasAttribute('required') || (associatedLabel && associatedLabel.classList.contains('required-field'))) {
                        if (this.type === 'radio') {
                            elementToStyle = this.closest('div.mt-2.flex.space-x-4, div.mt-1.flex.space-x-4') || this.parentElement.parentElement;
                            isFieldValid = form.querySelector(`input[name="${this.name}"]:checked`);
                        } else if (this.type === 'checkbox') {
                            elementToStyle = this.closest('div.flex.items-start');
                            isFieldValid = this.checked;
                        } else {
                            isFieldValid = this.value.trim() !== '';
                        }
                        styleError(elementToStyle, !isFieldValid);
                    }
                });
            });


            // --- Form Submission Handler ---
            form.addEventListener('submit', function (e) {
                console.log("Form submit event triggered!");
                e.preventDefault();
                console.log("Default form submission prevented.");

                let isValid = true;
                if(errorMessageDiv) errorMessageDiv.classList.add('hidden');
                if(successMessageDiv) successMessageDiv.classList.add('hidden');

                // Clear all previous error styles
                form.querySelectorAll('.border-red-500').forEach(el => el.classList.remove('border-red-500'));
                form.querySelectorAll('.border-2.rounded-md.p-1').forEach(el => el.classList.remove('border-2', 'rounded-md', 'p-1'));


                allRequiredFieldLabels.forEach(label => {
                    const fieldDiv = label.closest('div');
                    // Find the input associated with this required label
                    let inputElement = form.elements[label.getAttribute('for')]; 
                    if (!inputElement && fieldDiv) { // Fallback for radio/checkbox groups where label isn't for a single input
                         inputElement = fieldDiv.querySelector('input[type="radio"], input[type="checkbox"], select, textarea') || fieldDiv.querySelector('input:not([type="hidden"])');
                    }
                    if (inputElement && inputElement.name && form.elements[inputElement.name] && form.elements[inputElement.name].length && !form.elements[inputElement.name].nodeType) {
                        inputElement = form.elements[inputElement.name][0]; // First element of a radio group
                    }


                    if (inputElement) {
                        let fieldHasError = false;
                        // Skip validation for inputs within hidden optional sections
                        if ((inputElement.closest('#nnw-options-div') && nnwOptInCheckbox && !nnwOptInCheckbox.checked) ||
                            (inputElement.closest('#oc-swiad-options-div') && ocSwiadOptInCheckbox && !ocSwiadOptInCheckbox.checked)) {
                            return; // Skip this field
                        }
                         // Skip claimsAmount if not required
                        if (inputElement.id === 'claims-amount' && !inputElement.hasAttribute('required')) {
                            return;
                        }


                        if (inputElement.type === 'radio') {
                            if (!form.querySelector(`input[name="${inputElement.name}"]:checked`)) {
                                fieldHasError = true;
                            }
                        } else if (inputElement.type === 'checkbox') {
                            if (!inputElement.checked) {
                                fieldHasError = true;
                            }
                        } else if (inputElement.value.trim() === '') {
                            fieldHasError = true;
                        }

                        if (fieldHasError) {
                            isValid = false;
                            styleError(inputElement, true);
                        }
                    }
                });


                if (isValid) {
                    if(submitBtn) { /* ... disable button ... */ }
                    const formDataObj = new FormData(form);
                    if (nnwOptInCheckbox && !nnwOptInCheckbox.checked) { /* delete NNW fields */ }
                    if (ocSwiadOptInCheckbox && !ocSwiadOptInCheckbox.checked) { /* delete OC Swiad fields */ }

                    fetch(form.action, { method: 'POST', body: formDataObj })
                    .then(response => { /* ... */ return response.json();})
                    .then(data => { 
                        if (data.result === "success") {
                            /* ... success message, form.reset() ... */
                            // Manual reset/cleanup for dynamic/dependent fields
                            if(endDateInput) endDateInput.value = '';
                            if(ocZawodowePremiumDisplay) ocZawodowePremiumDisplay.textContent = '--- PLN';
                            if(calculatedOcZawodowePremiumInput) calculatedOcZawodowePremiumInput.value = '';
                            
                            if(nnwOptInCheckbox) nnwOptInCheckbox.checked = false;
                            if(nnwOptionsDiv) nnwOptionsDiv.classList.add('hidden');
                            if(nnwSumGuaranteedSelect) { nnwSumGuaranteedSelect.value = ''; nnwSumGuaranteedSelect.removeAttribute('required'); }
                            if(nnwPremiumDisplay) nnwPremiumDisplay.textContent = '--- PLN';
                            if(calculatedNnwPremiumInput) calculatedNnwPremiumInput.value = '';
                            nnwAssociationMemberRadios.forEach(r => r.checked = false);
                            const nnwSumLabel = document.querySelector('label[for="nnw-sum-guaranteed"]');
                            if(nnwSumLabel) nnwSumLabel.classList.remove('required-field');
                            const nnwMemberLabel = nnwSumGuaranteedSelect?.parentElement.nextElementSibling.querySelector('label');
                            if(nnwMemberLabel) nnwMemberLabel.classList.remove('required-field');


                            if(ocSwiadOptInCheckbox) ocSwiadOptInCheckbox.checked = false;
                            if(ocSwiadOptionsDiv) ocSwiadOptionsDiv.classList.add('hidden');
                            if(ocSwiadPremiumDisplay) ocSwiadPremiumDisplay.textContent = '--- PLN';
                            if(calculatedOcSwiadPremiumInput) calculatedOcSwiadPremiumInput.value = '';
                            ocSwiadAssociationMemberRadios.forEach(r => r.checked = false);
                            const ocSwiadMemberLabel = ocSwiadAssociationMemberRadios[0]?.closest('div.mt-1.flex.space-x-4')?.previousElementSibling;
                            if(ocSwiadMemberLabel) ocSwiadMemberLabel.classList.remove('required-field');
                            
                            if(claimsAmountDiv) claimsAmountDiv.classList.add('hidden');
                            if(claimsAmountInput) { claimsAmountInput.value = ''; claimsAmountInput.removeAttribute('required');}

                            form.querySelectorAll('.border-red-500').forEach(el => el.classList.remove('border-red-500'));
                            form.querySelectorAll('.border-2.rounded-md.p-1').forEach(el => el.classList.remove('border-2','rounded-md','p-1'));

                            if(progressBar) progressBar.style.width = '0%';
                            if (signDateInput) signDateInput.value = getLocalDateString(new Date());
                            if (startDateInput) startDateInput.setAttribute('min', getLocalDateString(new Date()));
                        } else { throw new Error(data.message || 'Błąd serwera.'); }
                    })
                    .catch(error => { /* ... error handling ... */ })
                    .finally(() => { if(submitBtn) { /* ... enable button ... */ } });
                } else {
                    if(errorMessageDiv) { /* ... show error message ... scroll to first error ... */ }
                }
            });
        });
    </script>
</body>

</html>